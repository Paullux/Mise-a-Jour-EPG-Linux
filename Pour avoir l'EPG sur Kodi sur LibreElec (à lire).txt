Installer l'extension Docker sur LibreElec
------------------------------------------------------------------------------------------------------
======================================================================================================
------------------------------------------------------------------------------------------------------
Pour installer le docker Perl pour processeur ARM :
------------------------------------------------------------------------------------------------------
~# docker pull armhf/perl:5.24.1
------------------------------------------------------------------------------------------------------
======================================================================================================
------------------------------------------------------------------------------------------------------
Création des deux Dockers :
------------------------------------------------------------------------------------------------------
~# mkdir Dockerfilexmltv
~# cd Dockerfilexmltv
~# nano Dockerfile
------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
Fichier : Dockerfile
------------------------------------------------------------------------------------------------------
FROM armhf/perl:5.24.1
RUN curl -SLO https://sourceforge.net/projects/xmltv/files/xmltv/0.5.69/xmltv-0.5.69.tar.bz2 \
    && tar xjf xmltv-0.5.69.tar.bz2 \
    && cd xmltv-0.5.69 \
    && cpanm Term::ReadKey \
    && cpanm JSON \
    && cpanm Date::Parse \
    && cpanm LWP::Protocol::https \
    && cpanm Digest::HMAC \
    && echo y | cpanm --verbose .
------------------------------------------------------------------------------------------------------
Pour compiler le Docker :
------------------------------------------------------------------------------------------------------
~# docker build -t xmltv .
------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
~# mkdir result
~# cd result
~# nano Dockerfile
------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
Fichier : Dockerfile
------------------------------------------------------------------------------------------------------
FROM xmltv:latest
COPY . /usr/src/myapp
WORKDIR /usr/src/myapp
CMD [ "perl", "./your-daemon-or-script.pl" ]
------------------------------------------------------------------------------------------------------
Pour compiler le docker
------------------------------------------------------------------------------------------------------
docker build -t my-perl-app .
------------------------------------------------------------------------------------------------------
======================================================================================================
------------------------------------------------------------------------------------------------------
faut aller dans un dossier avec tv_grab_fr_telerama tv_grab_fr_telerama.conf complet.xml pour moi $HOME
------------------------------------------------------------------------------------------------------
~# cd
------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
Pour utiliser un script Perl sous LibreElec (exemple) :
------------------------------------------------------------------------------------------------------
~# docker run --rm --name my-running-script -v "$HOME":/usr/src/myapp -w /usr/src/myapp xmltv perl tv_grab_fr_telerama --config-file=tv_grab_fr_telerama.conf --output=complet.xml
------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------
Pour arrêter de tous les dockers (peut être utile) :
------------------------------------------------------------------------------------------------------
docker stop `docker ps -q`
------------------------------------------------------------------------------------------------------
Chemin d'accès complet à l'exécutable docker :
------------------------------------------------------------------------------------------------------
.kodi/addons/service.system.docker/bin/docker
------------------------------------------------------------------------------------------------------
======================================================================================================
------------------------------------------------------------------------------------------------------
Fichier : MiseAJourEPG.sh
------------------------------------------------------------------------------------------------------
#!/bin/bash
DIR=/storage/

/storage/.kodi/addons/service.system.docker/bin/docker r$
 --rm --name my-running-script -v \
"$DIR":/usr/src/myapp -w /usr/src/myapp \
xmltv perl tv_grab_fr_telerama \
--config-file=tv_grab_fr_telerama.conf \
--output=complet.xml

cp complet.xml /media/My\ Passport/IPTV/complet.xml

exit 0
------------------------------------------------------------------------------------------------------
======================================================================================================
------------------------------------------------------------------------------------------------------
Editer cronie :
------------------------------------------------------------------------------------------------------
~# crontab -e
------------------------------------------------------------------------------------------------------
0 4 * * * "/storage/MiseAJourEPG.sh" &
0 5 * * * systemctl restart kodi
------------------------------------------------------------------------------------------------------
======================================================================================================
------------------------------------------------------------------------------------------------------
